---
import postsData from "../content/blog/post.json";

const posts = Array.isArray(postsData) ? postsData : [postsData];

const postsWithTimestamps = posts
  .map(post => {
    const time = Date.parse(post.publishedAt);
    return { ...post, timestamp: isNaN(time) ? 0 : time };
  });

const sortedPosts = postsWithTimestamps.sort((a, b) => b.timestamp - a.timestamp);

const latestPost = sortedPosts[0];
---

{latestPost && (
  <div class="max-w-5xl mx-auto lg:min-w-5xl pb-16">
    <div class="grid grid-cols-1 lg:grid-cols-2 space-x-8 items-center bg-gray-100 rounded-xl">
      {latestPost.heroImage?.url && (
        <div class="relative w-full h-72 lg:h-96 overflow-hidden rounded-2xl">
          <div class="absolute top-4 left-4 bg-primary-dark text-white px-3 py-1 rounded-md text-sm font-semibold z-10">
            Lee lo más reciente
          </div>
          <img
            src={latestPost.heroImage.url}
            alt={latestPost.title}
            class="w-full h-full object-cover hover:scale-105 transition-transform duration-500"
          />
        </div>
      )}

      <div class="flex flex-col justify-center space-y-5 px-2">
        <h2 class="text-3xl lg:text-4xl font-bold leading-tight">
          {latestPost.title}
        </h2>

        <p class="text-gray-600 dark:text-gray-300 line-clamp-3">
          {latestPost.description || "Lee nuestro artículo más reciente."}
        </p>

        <a
          href={`/blog/${latestPost.slug}`}
          class="inline-flex items-center gap-2 bg-primary text-white px-5 py-3 rounded-xl font-medium hover:bg-primary-dark transition-colors w-fit"
        >
          Leer artículo
        </a>
      </div>
    </div>
  </div>
)}